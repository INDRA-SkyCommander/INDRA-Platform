import subprocess
import os
import GUI
import indra_util


def run_exploit(gui_selected_module):
    print(f"Running Module: {gui_selected_module}")
    # Capture Path to module_input_data.json file
    module_input_file_path = os.path.dirname(__file__) + "/../modules/module_input_data.json"
    
    with open(module_input_file_path, "w") as f:
        # Capture current target's name and info
        target_name = indra_util.get_target()
        target_info = indra_util.get_info()
        # Write contents of indra_util.current_target to modules/module_input_data.json
        f.write(target_name)
        # Write contents of indra_util.target_info_list to modules/module_input_data.json
        for item in target_info:
                f.write(str(item).strip())
                f.write("\n")

    module_return_code = subprocess.call(['python', f'modules/{gui_selected_module}.py'])